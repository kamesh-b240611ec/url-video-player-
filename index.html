<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Universal Video Player</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * {
            box-sizing: border-box;
            touch-action: manipulation;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            overscroll-behavior: none;
        }
        
        .video-container {
            position: relative;
            width: 100%;
            background: black;
            overflow: hidden;
        }
        
        .video-wrapper {
            position: relative;
            width: 100%;
            padding-top: 56.25%; /* Default 16:9 aspect ratio */
        }
        
        #videoPlayer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            background: transparent;
            cursor: pointer;
            height: 16px;
        }
        
        input[type="range"]::-webkit-slider-runnable-track {
            background: rgba(255, 255, 255, 0.3);
            height: 4px;
            border-radius: 2px;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            background-color: #fff;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            margin-top: -6px;
        }
        
        input[type="range"]::-moz-range-track {
            background: rgba(255, 255, 255, 0.3);
            height: 4px;
            border-radius: 2px;
            border: none;
        }
        
        input[type="range"]::-moz-range-thumb {
            background-color: #fff;
            height: 16px;
            width: 16px;
            border-radius: 50%;
            border: none;
        }
        
        .controls-hidden .custom-controls {
            opacity: 0;
            transform: translateY(100%);
            pointer-events: none;
        }
        
        .center-controls {
            opacity: 0;
            transition: opacity 0.3s ease;
            pointer-events: none;
        }
        
        .video-container:hover .center-controls,
        .video-container.touch-active .center-controls,
        .video-container.paused .center-controls {
            opacity: 1;
            pointer-events: auto;
        }
        
        .control-button {
            width: 44px;
            height: 44px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            font-size: 1.2rem;
            transition: all 0.2s ease;
            -webkit-tap-highlight-color: transparent;
        }
        
        .control-button:active {
            transform: scale(0.95);
            background: rgba(0, 0, 0, 0.7);
        }
        
        .seek-button {
            width: 50px;
            height: 50px;
            font-size: 1.4rem;
        }
        
        .play-button {
            width: 60px;
            height: 60px;
            font-size: 1.8rem;
        }
        
        .custom-controls {
            transition: all 0.3s ease;
            padding-bottom: 8px;
        }
        
        /* Fullscreen styles */
        .video-container:fullscreen {
            background: black;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .video-container:fullscreen .video-wrapper {
            width: 100%;
            height: 100%;
            padding-top: 0;
            max-width: 100%;
            max-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        .video-container:fullscreen #videoPlayer {
            position: relative;
            object-fit: contain;
            max-width: 100%;
            max-height: 100vh;
        }
        
        /* Mobile optimization */
        @media (max-width: 768px) {
            .video-wrapper {
                padding-top: 56.25%; /* Maintain 16:9 on mobile by default */
            }
            
            .control-button {
                width: 40px;
                height: 40px;
                font-size: 1.1rem;
            }
            
            .seek-button {
                width: 44px;
                height: 44px;
                font-size: 1.2rem;
            }
            
            .play-button {
                width: 54px;
                height: 54px;
                font-size: 1.6rem;
            }
            
            .controls-row {
                padding: 0 8px;
            }
            
            .time-display {
                font-size: 0.8rem;
            }
            
            /* Better mobile controls spacing */
            .custom-controls {
                padding: 0 8px 8px;
            }
            
            .time-row {
                margin-bottom: 4px;
            }
        }
        
        /* Prevent zoom on input focus on mobile */
        @media screen and (max-width: 768px) {
            input[type="text"] {
                font-size: 16px;
            }
        }
        
        /* Aspect ratio classes */
        .ratio-16-9 {
            padding-top: 56.25%;
        }
        
        .ratio-4-3 {
            padding-top: 75%;
        }
        
        .ratio-1-1 {
            padding-top: 100%;
        }
        
        .ratio-21-9 {
            padding-top: 42.85%;
        }
        
        .ratio-original {
            padding-top: 0;
            height: auto;
        }
        
        .ratio-fit {
            padding-top: 0;
            height: 70vh;
        }
        
        /* Loading spinner */
        .spinner {
            width: 40px;
            height: 40px;
            border: 4px solid rgba(255, 255, 255, 0.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .hidden {
            display: none;
        }
        
        /* New time display layout */
        .time-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            width: 100%;
            padding: 0 8px;
            margin-bottom: 6px;
        }
        
        .current-time, .duration {
            font-size: 0.8rem;
            font-variant-numeric: tabular-nums;
        }
        
        .progress-container {
            width: 100%;
            padding: 0 8px;
        }
    </style>
</head>
<body class="bg-gray-100 text-gray-800">
    <div class="container mx-auto px-2 py-4 max-w-4xl">
        <header class="text-center mb-4">
            <h1 class="text-2xl md:text-3xl font-bold text-blue-600 mb-1">Universal Video Player</h1>
            <p class="text-sm md:text-base text-gray-600">Play videos from any URL on any device</p>
        </header>

        <div class="bg-white rounded-lg shadow-md overflow-hidden">
            <div id="videoContainer" class="video-container">
                <div id="videoWrapper" class="video-wrapper ratio-16-9">
                    <video id="videoPlayer" preload="metadata" playsinline>
                        Your browser does not support the video tag.
                    </video>
                    
                    <div id="videoPlaceholder" class="absolute inset-0 flex items-center justify-center bg-gray-900 text-white">
                        <div class="text-center p-4">
                            <i class="fas fa-play-circle text-4xl md:text-5xl text-blue-400 mb-2"></i>
                            <h3 class="text-lg md:text-xl font-semibold mb-1">Paste a video URL to play</h3>
                            <p class="text-xs md:text-sm text-gray-300">Supports MP4, WebM, MOV and more</p>
                        </div>
                    </div>

                    <div id="loadingSpinner" class="absolute inset-0 flex items-center justify-center bg-black bg-opacity-50 hidden">
                        <div class="spinner"></div>
                    </div>

                    <!-- Center controls with play/pause and seek buttons -->
                    <div class="center-controls absolute inset-0 flex justify-center items-center gap-4 md:gap-8 z-10">
                        <button id="seekBack10s" class="control-button seek-button">
                            <i class="fas fa-backward"></i>
                        </button>
                        <button id="centerPlayPause" class="control-button play-button">
                            <i class="fas fa-play" id="centerPlayIcon"></i>
                        </button>
                        <button id="seekForward10s" class="control-button seek-button">
                            <i class="fas fa-forward"></i>
                        </button>
                    </div>

                    <div class="custom-controls absolute bottom-0 left-0 right-0 z-20 text-white bg-gradient-to-t from-black/80 to-transparent">
                        <!-- Time display above progress bar -->
                        <div class="time-row">
                            <span id="currentTime" class="current-time">00:00:00</span>
                            <span id="duration" class="duration">00:00:00</span>
                        </div>
                        
                        <!-- Progress bar -->
                        <div class="progress-container">
                            <input type="range" id="progressBar" min="0" max="100" value="0" class="w-full">
                        </div>
                        
                        <!-- Controls row -->
                        <div class="flex items-center justify-between controls-row px-3 pb-2 mt-2">
                            <div class="flex items-center gap-2 md:gap-3">
                                <button id="playPauseBtn" class="control-button">
                                    <i id="playPauseIcon" class="fas fa-play"></i>
                                </button>
                                <div class="flex items-center gap-1 md:gap-2">
                                    <button id="volumeBtn" class="control-button">
                                        <i id="volumeIcon" class="fas fa-volume-up"></i>
                                    </button>
                                    <input type="range" id="volumeSlider" min="0" max="1" step="0.01" value="1" class="w-12 md:w-16">
                                </div>
                            </div>
                            <div class="flex items-center gap-2 md:gap-3">
                                <button id="speedBtn" class="control-button text-xs font-medium">
                                    1x
                                </button>
                                <button id="aspectRatioBtn" class="control-button">
                                    <i class="fas fa-expand-arrows-alt"></i>
                                </button>
                                <button id="fullscreenBtn" class="control-button">
                                    <i class="fas fa-expand"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="p-3 md:p-4">
                <div class="flex flex-col sm:flex-row gap-2">
                    <input type="text" id="videoUrl" placeholder="Paste video URL here..." class="flex-grow px-3 py-2 md:px-4 md:py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 outline-none text-sm md:text-base">
                    <button id="loadBtn" class="px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 text-sm md:text-base">
                        <i class="fas fa-play mr-1 md:mr-2"></i> Play
                    </button>
                </div>
            </div>
        </div>
        
        <div class="mt-4 text-center text-gray-500 text-xs md:text-sm">
            <p>Tap video to show controls. Use arrow keys to seek and adjust volume.</p>
        </div>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', function() {
        // Elements
        const videoUrlInput = document.getElementById('videoUrl');
        const loadBtn = document.getElementById('loadBtn');
        const videoContainer = document.getElementById('videoContainer');
        const videoWrapper = document.getElementById('videoWrapper');
        const videoPlayer = document.getElementById('videoPlayer');
        const videoPlaceholder = document.getElementById('videoPlaceholder');
        const loadingSpinner = document.getElementById('loadingSpinner');
        
        // Control elements
        const playPauseBtn = document.getElementById('playPauseBtn');
        const playPauseIcon = document.getElementById('playPauseIcon');
        const centerPlayPause = document.getElementById('centerPlayPause');
        const centerPlayIcon = document.getElementById('centerPlayIcon');
        const volumeBtn = document.getElementById('volumeBtn');
        const volumeIcon = document.getElementById('volumeIcon');
        const volumeSlider = document.getElementById('volumeSlider');
        const currentTimeEl = document.getElementById('currentTime');
        const durationEl = document.getElementById('duration');
        const progressBar = document.getElementById('progressBar');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const speedBtn = document.getElementById('speedBtn');
        const aspectRatioBtn = document.getElementById('aspectRatioBtn');
        const seekBack10s = document.getElementById('seekBack10s');
        const seekForward10s = document.getElementById('seekForward10s');

        // State variables
        let controlsTimeout;
        let isSpeed2x = false;
        let isSeeking = false;
        let isFullscreen = false;
        let isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);
        let lastTap = 0;
        
        // Aspect ratio options
        const aspectRatios = [
            { class: 'ratio-16-9', name: '16:9' },
            { class: 'ratio-4-3', name: '4:3' },
            { class: 'ratio-1-1', name: '1:1' },
            { class: 'ratio-21-9', name: '21:9' },
            { class: 'ratio-original', name: 'Original' },
            { class: 'ratio-fit', name: 'Fit to Screen' }
        ];
        let currentAspectRatioIndex = 0;
        
        // Format time function (supports hours)
        const formatTime = (timeInSeconds) => {
            const time = Math.round(timeInSeconds);
            const hours = Math.floor(time / 3600);
            const minutes = Math.floor((time % 3600) / 60);
            const seconds = Math.floor(time % 60);
            
            return `${String(hours).padStart(2, '0')}:${String(minutes).padStart(2, '0')}:${String(seconds).padStart(2, '0')}`;
        };

        // Toggle play/pause
        const togglePlay = () => {
            if (videoPlayer.paused) {
                videoPlayer.play();
                videoContainer.classList.remove('paused');
            } else {
                videoPlayer.pause();
                videoContainer.classList.add('paused');
            }
        };

        // Hide controls after delay
        const hideControls = () => {
            if (videoPlayer.paused) return;
            videoContainer.classList.add('controls-hidden');
            videoContainer.classList.remove('touch-active');
        };

        // Show controls
        const showControls = () => {
            videoContainer.classList.remove('controls-hidden');
            clearTimeout(controlsTimeout);
            
            // Set different timeout for mobile vs desktop
            const timeoutDuration = isMobile ? 3000 : 2500;
            controlsTimeout = setTimeout(hideControls, timeoutDuration);
        };

        // Update play/pause icons
        const updatePlayPauseIcons = (isPlaying) => {
            if (isPlaying) {
                playPauseIcon.className = "fas fa-pause";
                centerPlayIcon.className = "fas fa-pause";
                videoContainer.classList.remove('paused');
            } else {
                playPauseIcon.className = "fas fa-play";
                centerPlayIcon.className = "fas fa-play";
                videoContainer.classList.add('paused');
            }
        };

        // Load video from URL
        loadBtn.addEventListener('click', () => {
            const url = videoUrlInput.value.trim();
            if (url) {
                videoPlaceholder.classList.add('hidden');
                loadingSpinner.classList.remove('hidden');
                videoPlayer.src = url;
                videoPlayer.load();
                
                // Reset aspect ratio to default when loading new video
                currentAspectRatioIndex = 0;
                videoWrapper.className = 'video-wrapper ratio-16-9';
                
                videoPlayer.play().catch(e => {
                    loadingSpinner.classList.add('hidden');
                    alert('Error playing video: ' + e.message);
                });
            } else {
                alert('Please enter a video URL');
            }
        });
        
        // Video player events
        videoPlayer.addEventListener('play', () => {
            updatePlayPauseIcons(true);
            showControls();
            loadingSpinner.classList.add('hidden');
        });
        
        videoPlayer.addEventListener('pause', () => {
            updatePlayPauseIcons(false);
            videoContainer.classList.remove('controls-hidden');
            loadingSpinner.classList.add('hidden');
        });
        
        videoPlayer.addEventListener('waiting', () => {
            loadingSpinner.classList.remove('hidden');
        });
        
        videoPlayer.addEventListener('playing', () => {
            loadingSpinner.classList.add('hidden');
        });
        
        videoPlayer.addEventListener('loadedmetadata', () => {
            currentTimeEl.textContent = formatTime(0);
            durationEl.textContent = formatTime(videoPlayer.duration);
            
            // Auto-set aspect ratio based on video dimensions for original option
            const videoRatio = videoPlayer.videoWidth / videoPlayer.videoHeight;
            if (videoRatio && isFinite(videoRatio)) {
                // Update the original ratio class
                videoWrapper.style.paddingTop = videoRatio > 0 ? `${(1/videoRatio)*100}%` : '56.25%';
            }
        });
        
        videoPlayer.addEventListener('timeupdate', () => {
            if (!isSeeking) {
                const progressPercent = (videoPlayer.currentTime / videoPlayer.duration) * 100;
                progressBar.value = progressPercent;
            }
            currentTimeEl.textContent = formatTime(videoPlayer.currentTime);
            durationEl.textContent = formatTime(videoPlayer.duration);
        });
        
        videoPlayer.addEventListener('volumechange', () => {
            volumeSlider.value = videoPlayer.volume;
            if (videoPlayer.muted || videoPlayer.volume === 0) {
                volumeIcon.className = "fas fa-volume-mute";
            } else if (videoPlayer.volume < 0.5) {
                volumeIcon.className = "fas fa-volume-down";
            } else {
                volumeIcon.className = "fas fa-volume-up";
            }
        });

        // Control visibility
        videoContainer.addEventListener('mousemove', showControls);
        videoContainer.addEventListener('mouseleave', () => { 
            if (!videoPlayer.paused) hideControls(); 
        });
        
        // Touch controls for mobile
        let touchStartX = 0;
        let touchStartY = 0;
        let touchStartTime = 0;
        let seekAmount = 0;
        
        videoContainer.addEventListener('touchstart', (e) => {
            videoContainer.classList.add('touch-active');
            showControls();
            
            touchStartX = e.touches[0].clientX;
            touchStartY = e.touches[0].clientY;
            touchStartTime = Date.now();
            seekAmount = 0;
            
            // Double tap to play/pause
            const currentTime = new Date().getTime();
            const tapLength = currentTime - lastTap;
            if (tapLength < 300 && tapLength > 0) {
                togglePlay();
            }
            lastTap = currentTime;
            
            // Prevent default to avoid scrolling when interacting with video
            if (e.target === videoPlayer || e.target === progressBar) {
                e.preventDefault();
            }
        }, { passive: false });
        
        videoContainer.addEventListener('touchmove', (e) => {
            if (videoContainer.classList.contains('touch-active')) {
                // Horizontal swipe for seeking
                const touchX = e.touches[0].clientX;
                const deltaX = touchX - touchStartX;
                
                // Only consider it a seek gesture if horizontal movement is significant
                if (Math.abs(deltaX) > 30) {
                    seekAmount = deltaX / 2; // Adjust sensitivity
                    e.preventDefault(); // Prevent scrolling when seeking
                }
            }
        }, { passive: false });
        
        videoContainer.addEventListener('touchend', (e) => {
            if (seekAmount !== 0) {
                videoPlayer.currentTime += seekAmount / 100 * videoPlayer.duration;
                seekAmount = 0;
            }
            
            // Single tap to toggle controls
            const touchEndTime = Date.now();
            if (touchEndTime - touchStartTime < 300) {
                if (videoContainer.classList.contains('controls-hidden')) {
                    showControls();
                } else {
                    hideControls();
                }
            }
        });
        
        // Control buttons
        playPauseBtn.addEventListener('click', togglePlay);
        centerPlayPause.addEventListener('click', togglePlay);
        
        volumeBtn.addEventListener('click', () => {
            videoPlayer.muted = !videoPlayer.muted;
        });
        
        volumeSlider.addEventListener('input', (e) => {
            videoPlayer.volume = e.target.value;
            videoPlayer.muted = false;
        });
        
        progressBar.addEventListener('input', (e) => {
            isSeeking = true;
            const seekTime = (e.target.value / 100) * videoPlayer.duration;
            videoPlayer.currentTime = seekTime;
            currentTimeEl.textContent = formatTime(seekTime);
        });
        
        progressBar.addEventListener('change', () => {
            isSeeking = false;
        });
        
        fullscreenBtn.addEventListener('click', () => {
            if (!document.fullscreenElement) {
                if (videoContainer.requestFullscreen) {
                    videoContainer.requestFullscreen();
                } else if (videoContainer.webkitRequestFullscreen) {
                    videoContainer.webkitRequestFullscreen();
                } else if (videoContainer.msRequestFullscreen) {
                    videoContainer.msRequestFullscreen();
                }
                isFullscreen = true;
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
                isFullscreen = false;
            }
        });

        // 10-second seek buttons
        seekBack10s.addEventListener('click', () => {
            videoPlayer.currentTime = Math.max(0, videoPlayer.currentTime - 10);
            showControls();
        });
        
        seekForward10s.addEventListener('click', () => {
            videoPlayer.currentTime = Math.min(videoPlayer.duration, videoPlayer.currentTime + 10);
            showControls();
        });

        // Speed control (only 1x and 2x)
        speedBtn.addEventListener('click', () => {
            isSpeed2x = !isSpeed2x;
            videoPlayer.playbackRate = isSpeed2x ? 2.0 : 1.0;
            speedBtn.textContent = videoPlayer.playbackRate + 'x';
            showControls();
        });

        // Aspect ratio control
        aspectRatioBtn.addEventListener('click', () => {
            // Remove current aspect ratio class
            videoWrapper.className = 'video-wrapper';
            
            // Cycle to next aspect ratio
            currentAspectRatioIndex = (currentAspectRatioIndex + 1) % aspectRatios.length;
            
            // Add new aspect ratio class
            videoWrapper.classList.add(aspectRatios[currentAspectRatioIndex].class);
            
            showControls();
        });

        // Keyboard controls
        document.addEventListener('keydown', (e) => {
            if (document.activeElement === videoUrlInput) return;
            
            switch (e.key.toLowerCase()) {
                case " ":
                    e.preventDefault();
                    togglePlay();
                    break;
                case "f":
                    fullscreenBtn.click();
                    break;
                case "m":
                    videoPlayer.muted = !videoPlayer.muted;
                    break;
                case "arrowright":
                    videoPlayer.currentTime += 10;
                    break;
                case "arrowleft":
                    videoPlayer.currentTime -= 10;
                    break;
                case "arrowup":
                    videoPlayer.volume = Math.min(1, videoPlayer.volume + 0.1);
                    break;
                case "arrowdown":
                    videoPlayer.volume = Math.max(0, videoPlayer.volume - 0.1);
                    break;
                case "1":
                    videoPlayer.playbackRate = 1.0;
                    isSpeed2x = false;
                    speedBtn.textContent = '1x';
                    break;
                case "2":
                    videoPlayer.playbackRate = 2.0;
                    isSpeed2x = true;
                    speedBtn.textContent = '2x';
                    break;
            }
        });

        // Handle fullscreen change events
        document.addEventListener('fullscreenchange', () => {
            isFullscreen = !!document.fullscreenElement;
            if (isFullscreen) {
                // Adjust for fullscreen
                document.body.style.overflow = 'hidden';
            } else {
                // Reset when exiting fullscreen
                document.body.style.overflow = 'auto';
            }
        });
        
        document.addEventListener('webkitfullscreenchange', () => {
            isFullscreen = !!document.webkitFullscreenElement;
            if (isFullscreen) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = 'auto';
            }
        });
        
        document.addEventListener('msfullscreenchange', () => {
            isFullscreen = !!document.msFullscreenElement;
            if (isFullscreen) {
                document.body.style.overflow = 'hidden';
            } else {
                document.body.style.overflow = 'auto';
            }
        });

        // Auto-hide controls on mobile after delay
        if (isMobile) {
            // Longer timeout on mobile
            controlsTimeout = setTimeout(hideControls, 3000);
        }
    });
    </script>
</body>
</html>
